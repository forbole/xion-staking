(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46601:function(){},89214:function(){},42480:function(){},85568:function(){},69386:function(){},31616:function(){},20131:function(){},16026:function(){},33370:function(){},96496:function(e,t,n){Promise.resolve().then(n.bind(n,68454))},68454:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(3827),a=n(52674),i=n(80469),s=n(62331),o=n(8792),d=n(64090),l=n(65617),c=n(26221),u=n(12255),m=n(18722),v=()=>{let[e,t]=(0,d.useState)(null);return((0,d.useEffect)(()=>{(async()=>{var e;let n=localStorage.getItem("xion-authz-temp-account");if(!n)return;let r=await m.DirectSecp256k1HdWallet.deserialize(n,"abstraxion"),a=await r.getAccounts(),i=null==a?void 0:null===(e=a[0])||void 0===e?void 0:e.address;i&&t(i)})()},[]),e)?(0,r.jsx)(o.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e),target:"_blank",children:(0,r.jsx)(s.z,{onClick:()=>{},children:"DEBUG ACCOUNT"})}):null};let f=e=>{let{disabled:t,onStake:n,validator:a}=e,{website:i}=a.description;return(0,r.jsxs)("div",{style:{border:"solid 1ps white",marginBottom:10},children:[(0,r.jsx)("div",{children:(0,r.jsx)("b",{children:a.description.moniker})}),(0,r.jsx)("div",{children:a.operatorAddress}),(0,r.jsx)("div",{children:(0,r.jsx)(s.z,{disabled:t,onClick:n,structure:"naked",children:"Stake here"})}),i&&(0,r.jsx)("div",{children:(0,r.jsx)(o.default,{href:i,target:"_blank",children:i})})]})};var h=(0,d.memo)(function(){let{account:e,staking:t}=(0,i.n)(),[n,m]=(0,d.useState)(!1),{delegations:h,tokens:x,validators:g}=t.state,{client:p}=(0,a.Hj)(),w=(null==g?void 0:g.items.reduce((e,t)=>(e[t.operatorAddress]=t,e),{}))||{};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{children:"Account"}),(0,r.jsx)("div",{children:(0,r.jsx)("b",{children:e.bech32Address})}),x&&(0,r.jsxs)("div",{children:["Tokens: ",(0,r.jsx)("b",{children:(0,c.E)(x)})]})]}),h&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:"Delegations:"}),h.items.map(n=>{let a=w[n.validatorAddress],i=null==a?void 0:a.description.moniker;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:["Delegated: ",(0,c.E)(n.balance)]}),n.rewards&&(0,r.jsxs)("div",{children:["Rewards: ",(0,c.E)(n.rewards)]}),(0,r.jsx)("div",{children:i||n.validatorAddress}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(s.z,{onClick:()=>{if(m(!0),!p)return;m(!0);let n={delegator:e.bech32Address,validator:a.operatorAddress};(0,l.yQ)(n,p,t).then(()=>{m(!1)})},children:"Undelegate"}),n.rewards&&(0,r.jsx)(s.z,{onClick:()=>{},children:"Claim rewards"}),(0,r.jsx)(s.z,{onClick:()=>{},children:"Redelelegate"})]})]},n.validatorAddress)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)(o.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e.bech32Address),target:"_blank",children:(0,r.jsx)(s.z,{onClick:()=>{},children:"VIEW ACCOUNT"})}),(0,r.jsx)(v,{})]}),g&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:"Validators:"}),(0,r.jsx)("div",{className:"max-h-[200px] max-w-max overflow-auto",children:g.items.map(a=>(0,r.jsx)(f,{disabled:n,onStake:()=>{if(!p)return;m(!0);let n={delegator:e.bech32Address,validator:a.operatorAddress};(0,l.yt)(n,p,t).then(()=>{m(!1)})},validator:a},a.operatorAddress))})]})]})});function x(){let[,e]=(0,a.dd)(),t=(0,d.useCallback)(()=>{e(!0)},[e]);return(0,r.jsx)("div",{className:"w-max",children:(0,r.jsx)(s.z,{fullWidth:!0,onClick:t,structure:"base",children:"CONNECT"})})}function g(){let{isLoggedIn:e}=(0,i.n)(),[t,n]=(0,a.dd)();return(0,r.jsxs)("main",{className:"m-auto flex min-h-screen max-w-xs flex-col items-center justify-center gap-4 p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold tracking-tighter text-black dark:text-white",children:"XION Staking"}),e?(0,r.jsx)(h,{}):(0,r.jsx)(x,{}),t&&(0,r.jsx)(a.my,{onClose:()=>{n(!1)}})]})}},65617:function(e,t,n){"use strict";n.d(t,{co:function(){return g},yt:function(){return p},yQ:function(){return w}});var r=n(26221),a=n(58015),i=n(43890),s=n(22840),o=n(62884),d=n(12255);let l=async()=>{let e=await i.Tendermint34Client.connect(d.Od);return a.QueryClient.withExtensions(e,a.setupStakingExtension,a.setupDistributionExtension,a.setupIbcExtension)},c=async()=>{let e=await l();return await e.staking.validators("BOND_STATUS_BONDED")},u=async e=>{let t=await a.StargateClient.connect(d.Od);return await t.getBalance(e,"uxion")},m=async e=>{let t=await l();return await t.staking.delegatorDelegations(e)},v=async(e,t)=>{let n=await l(),a=await n.distribution.delegationRewards(e,t);return(await Promise.all(a.rewards.map(async e=>{if(0==e.denom.indexOf("ibc/")){var t;let r=await n.ibc.transfer.denomTrace(e.denom.substring(4));e.denom=(null===(t=r.denomTrace)||void 0===t?void 0:t.baseDenom)||e.denom}return e}))).filter(e=>{var t;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"}).map(e=>({amount:new s.Z(e.amount).div(new s.Z(10).pow(18)).toString(),denom:e.denom})).map(e=>(0,r.b)(e))},f=async(e,t,n)=>{let r=o.MsgDelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator}),a={amount:[{amount:"1000",denom:"uxion"}],gas:"200000",granter:e.delegator};return await t.signAndBroadcast(e.delegator,[{typeUrl:"/cosmos.staking.v1beta1.MsgDelegate",value:r}],a)},h=async(e,t,n)=>{let r=o.MsgUndelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator}),a={amount:[{amount:"1000",denom:"uxion"}],gas:"200000",granter:e.delegator};return await t.signAndBroadcast(e.delegator,[{typeUrl:"/cosmos.staking.v1beta1.MsgUndelegate",value:r}],a)};var x=n(62986);let g=async(e,t)=>{try{let[n,a,i]=await Promise.all([u(e),c(),m(e).then(t=>Promise.all(t.delegationResponses.map(async t=>({balance:t.balance,rewards:await v(e,t.delegation.validatorAddress).then(e=>e.reduce((e,t)=>({amount:(parseFloat(e.amount)+parseFloat((0,r.b)(t).amount)).toString(),denom:t.denom}),{amount:"0",denom:"xion"})),validatorAddress:t.delegation.validatorAddress}))))]);t.dispatch((0,x.d0)(n)),t.dispatch((0,x.T2)({currentPage:0,items:a.validators})),t.dispatch((0,x.Qx)({currentPage:0,items:i}))}catch(e){console.error("error fetching staking data:",e)}},p=async(e,t,n)=>{await f(e,t,{amount:"1000",denom:"uxion"}),await g(e.delegator,n)},w=async(e,t,n)=>{await h(e,t,{amount:"1000",denom:"uxion"}),await g(e.delegator,n)}},80469:function(e,t,n){"use strict";n.d(t,{f:function(){return d},n:function(){return o}});var r=n(52674),a=n(64090),i=n(76958),s=n(65617);let o=()=>{let e=(0,a.useRef)({}),t=(0,a.useContext)(i.Y);e.current.state=t.state,e.current.dispatch=t.dispatch;let{data:n}=(0,r.hT)(),s=null==n?void 0:n.bech32Address;return{account:n,address:s,isLoggedIn:!!(null==n?void 0:n.bech32Address),staking:e.current}},d=()=>{let{address:e,isLoggedIn:t,staking:n}=o();(0,a.useEffect)(()=>{t&&e&&(0,s.co)(e,n)},[t,e,n])}},76958:function(e,t,n){"use strict";n.d(t,{W:function(){return a},Y:function(){return i}});var r=n(64090);let a={delegations:null,tokens:null,validators:null},i=(0,r.createContext)({dispatch:()=>null,state:a})},62986:function(e,t,n){"use strict";n.d(t,{I6:function(){return d},Qx:function(){return i},T2:function(){return a},d0:function(){return r}});let r=e=>({content:e,type:"SET_TOKENS"}),a=e=>({content:e,type:"ADD_VALIDATORS"}),i=e=>({content:e,type:"ADD_DELEGATIONS"}),s=e=>{let t=new Set;return e.filter(e=>!t.has(e.operatorAddress)&&(t.add(e.operatorAddress),!0))},o=e=>{let t=new Set;return e.filter(e=>!t.has(e.validatorAddress)&&(t.add(e.validatorAddress),!0))},d=(e,t)=>{switch(t.type){case"SET_TOKENS":return{...e,tokens:t.content};case"ADD_VALIDATORS":{let n=e.validators||{currentPage:0,items:[]};return n.currentPage+=1,n.items=s(n.items.concat(t.content.items)),{...e,validators:n}}case"ADD_DELEGATIONS":{let n=e.delegations||{currentPage:0,items:[]};return n.currentPage+=1,n.items=o(t.content.items.concat(n.items)),{...e,delegations:n}}default:return e}}},26221:function(e,t,n){"use strict";n.d(t,{E:function(){return i},b:function(){return a}});var r=n(22840);let a=e=>{var t,n,a;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"?{amount:new r.Z(e.amount).div(new r.Z(10).pow(6)).toString(),denom:"XION"}:(null===(n=e.denom)||void 0===n?void 0:n.toUpperCase())==="XION"?{amount:e.amount,denom:"XION"}:{...e,denom:null===(a=e.denom)||void 0===a?void 0:a.toUpperCase()}},i=e=>{let t=a(e),n=new r.Z(t.amount);return"".concat(n.toFormat()," ").concat(t.denom)}},12255:function(e,t,n){"use strict";n.d(t,{Bv:function(){return r},Od:function(){return i},T$:function(){return a}});let{chainId:r}=n(3436).testnetChainInfo,a=void 0,i="https://rpc.xion-testnet-1.burnt.com:443"}},function(e){e.O(0,[350,218,147,228,933,565,792,971,69,744],function(){return e(e.s=96496)}),_N_E=e.O()}]);