(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46601:function(){},89214:function(){},42480:function(){},85568:function(){},69386:function(){},31616:function(){},20131:function(){},16026:function(){},33370:function(){},96496:function(e,t,n){Promise.resolve().then(n.bind(n,68454))},68454:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var a=n(3827),i=n(52674),r=n(80469),o=n(59115),s=n(8792),l=n(64090),d=n(94108),c=n(66803),u=n(9016),m=n(18722),g=()=>{let[e,t]=(0,l.useState)(null);return((0,l.useEffect)(()=>{(async()=>{var e;let n=localStorage.getItem("xion-authz-temp-account");if(!n)return;let a=await m.DirectSecp256k1HdWallet.deserialize(n,"abstraxion"),i=await a.getAccounts(),r=null==i?void 0:null===(e=i[0])||void 0===e?void 0:e.address;r&&t(r)})()},[]),e)?(0,a.jsx)(s.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e),target:"_blank",children:(0,a.jsx)(o.z,{onClick:()=>{},children:"DEBUG ACCOUNT"})}):null};let v=e=>{let{disabled:t,onStake:n,validator:i}=e,{website:r}=i.description;return(0,a.jsxs)("div",{style:{border:"solid 1ps white",marginBottom:10},children:[(0,a.jsx)("div",{children:(0,a.jsx)("b",{children:i.description.moniker})}),(0,a.jsx)("div",{children:i.operatorAddress}),(0,a.jsx)("div",{children:(0,a.jsx)(o.z,{disabled:t,onClick:n,structure:"naked",children:"Stake here"})}),r&&(0,a.jsx)("div",{children:(0,a.jsx)(s.default,{href:r,target:"_blank",children:r})})]})};var x=(0,l.memo)(function(){let{account:e,staking:t}=(0,r.n)(),[n,m]=(0,l.useState)(!1),{delegations:x,tokens:h,unbondings:f,validators:p}=t.state,{client:w}=(0,i.Hj)(),[,b]=(0,i.dd)(),y=(0,l.useMemo)(()=>(null==p?void 0:p.items.reduce((e,t)=>(e[t.operatorAddress]=t,e),{}))||{},[p]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{children:"Account"}),(0,a.jsx)("div",{children:(0,a.jsx)("b",{children:e.bech32Address})}),(0,a.jsx)("div",{children:(0,a.jsx)(o.z,{onClick:()=>{b(!0)},children:"Open Settings"})}),h&&(0,a.jsxs)("div",{children:["Tokens: ",(0,a.jsx)("b",{children:(0,c.Em)(h)})]})]}),!!(null==x?void 0:x.items.length)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Delegations:"}),x.items.map(i=>{let r=y[i.validatorAddress],s=null==r?void 0:r.description.moniker;return(0,a.jsxs)("div",{style:{border:"1px solid #fff",marginBottom:20},children:[(0,a.jsxs)("div",{children:["Delegated: ",(0,c.Em)(i.balance)]}),i.rewards&&(0,a.jsxs)("div",{children:["Rewards: ",(0,c.Em)(i.rewards)]}),(0,a.jsxs)("div",{children:["Validator: ",s||i.validatorAddress]}),(0,a.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,a.jsx)(o.z,{disabled:n,onClick:()=>{if(!w||!r)return;m(!0);let n={delegator:e.bech32Address,validator:r.operatorAddress};(0,d.xu)(n,w,t).finally(()=>{m(!1)})},children:"Undelegate"}),i.rewards&&(0,a.jsx)(o.z,{disabled:n||"0"===i.rewards.amount,onClick:()=>{if(!w)return;m(!0);let n={delegator:e.bech32Address,validator:i.validatorAddress};(0,d.sT)(n,w,t).finally(()=>{m(!1)})},children:"Claim rewards"}),(0,a.jsx)(o.z,{disabled:n,onClick:()=>{w&&(m(!0),(0,d.d7)(e.bech32Address,w,t).finally(()=>{m(!1)}))},children:"Redelelegate"})]})]},i.validatorAddress)})]}),!!(null==f?void 0:f.items.length)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Unbondings:"}),(0,a.jsx)("div",{children:null==f?void 0:f.items.map(e=>{let t=y[e.validator];return(0,a.jsxs)("div",{style:{border:"1px solid #fff"},children:[(0,a.jsxs)("div",{children:["Unbonding tokens: ",(0,c.Em)(e.balance)]}),(0,a.jsxs)("div",{children:["Completed by:"," ",new Date(e.completionTime).toString()]}),(0,a.jsxs)("div",{children:["Validator:"," ",(null==t?void 0:t.description.moniker)||e.validator]})]},"".concat(e.completionTime,"-").concat(e.completionTimeNanos))})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,a.jsx)(s.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e.bech32Address),target:"_blank",children:(0,a.jsx)(o.z,{onClick:()=>{},children:"VIEW ACCOUNT"})}),(0,a.jsx)(g,{})]}),p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Validators:"}),(0,a.jsx)("div",{className:"max-h-[200px] max-w-max overflow-auto",children:p.items.map(i=>(0,a.jsx)(v,{disabled:n,onStake:()=>{if(!w)return;m(!0);let n={delegator:e.bech32Address,validator:i.operatorAddress};(0,d._5)(n,w,t).finally(()=>{m(!1)})},validator:i},i.operatorAddress))})]})]})});function h(){let[,e]=(0,i.dd)(),t=(0,l.useCallback)(()=>{e(!0)},[e]);return(0,a.jsx)("div",{className:"w-max",children:(0,a.jsx)(o.z,{fullWidth:!0,onClick:t,structure:"base",children:"CONNECT"})})}function f(){let{isConnected:e}=(0,r.n)(),[t,n]=(0,i.dd)();return(0,a.jsxs)(a.Fragment,{children:[e?(0,a.jsx)(x,{}):(0,a.jsx)(h,{}),t&&(0,a.jsx)(i.my,{onClose:()=>{n(!1)}})]})}},94108:function(e,t,n){"use strict";n.d(t,{sT:function(){return T},wX:function(){return S},d7:function(){return E},_5:function(){return N},xu:function(){return C}});var a=n(58015),i=n(22840),r=n(53856),o=n(62884),s=n(18722),l=n(43890),d=n(9016);let c=async()=>{let e=await l.Tendermint34Client.connect(d.Od);return a.QueryClient.withExtensions(e,a.setupStakingExtension,a.setupDistributionExtension,a.setupIbcExtension)},u=async()=>{let e=localStorage.getItem("xion-authz-temp-account");if(!e)return;let t=await s.DirectSecp256k1HdWallet.deserialize(e,"abstraxion"),n=await t.getAccounts().then(e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.address});return{client:await a.SigningStargateClient.connectWithSigner(d.Od,t),granteeAddress:n}};var m=n(66803),g=n(97481);let v=async(e,t)=>{let{client:n,granteeAddress:a}=await u()||{};if(!n||!a)return null;let i=[{typeUrl:"/cosmos.authz.v1beta1.MsgExec",value:g.MsgExec.fromPartial({grantee:a,msgs:e.map(e=>n.registry.encodeAsAny(e))})}];return await n.simulate(a,i,t).then(e=>(1.2*e).toString()).catch(e=>(console.log("debug: core/base.ts: Estimate error",e),null))},x=async e=>{let{address:t,amount:n=[{amount:"1000",denom:"uxion"}],gasLimit:a="400000",memo:i="",msgs:r}=e;return{amount:n,gas:await v(r,i)||a,granter:t}},h=async()=>{let e=await c();return await e.staking.validators("BOND_STATUS_BONDED")},f=async e=>{let t=await a.StargateClient.connect(d.Od);return await t.getBalance(e,"uxion")},p=async e=>{let t=await c();return await t.staking.delegatorDelegations(e)},w=async e=>{let t=await c();return await t.staking.delegatorUnbondingDelegations(e)},b=async(e,t)=>{let n=await c(),a=await n.distribution.delegationRewards(e,t);return(await Promise.all(a.rewards.map(async e=>{if(0==e.denom.indexOf("ibc/")){var t;let a=await n.ibc.transfer.denomTrace(e.denom.substring(4));e.denom=(null===(t=a.denomTrace)||void 0===t?void 0:t.baseDenom)||e.denom}return e}))).filter(e=>{var t;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"}).map(e=>({amount:new i.Z(e.amount).div(new i.Z(10).pow(18)).toString(),denom:e.denom})).map(e=>(0,m.bI)(e))},y=async(e,t,n)=>{let a={typeUrl:"/cosmos.staking.v1beta1.MsgDelegate",value:o.MsgDelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator})},i=await x({address:e.delegator,msgs:[a]});return await t.signAndBroadcast(e.delegator,[a],i)},A=async(e,t,n)=>{let a={typeUrl:"/cosmos.staking.v1beta1.MsgUndelegate",value:o.MsgUndelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator})},i=await x({address:e.delegator,msgs:[a]});return await t.signAndBroadcast(e.delegator,[a],i)},j=async(e,t)=>{let n={typeUrl:"/cosmos.distribution.v1beta1.MsgWithdrawDelegatorReward",value:r.MsgWithdrawDelegatorReward.fromPartial({delegatorAddress:e.delegator,validatorAddress:e.validator})},a=await x({address:e.delegator,msgs:[n]});return await t.signAndBroadcast(e.delegator,[n],a)},k=async(e,t)=>{let n={typeUrl:"/cosmos.staking.v1beta1.MsgBeginRedelegate",value:o.MsgBeginRedelegate.fromPartial({delegatorAddress:e})},a=await x({address:e,msgs:[n]});return await t.signAndBroadcast(e,[n],a)};var D=n(62986);let S=async(e,t)=>{try{var n,a,i,r,o,s;let[l,d,c,u]=await Promise.all([f(e),h(),p(e).then(async t=>({items:await Promise.all(t.delegationResponses.map(async t=>({balance:t.balance,rewards:await b(e,t.delegation.validatorAddress).then(e=>(0,m.HJ)(e)),validatorAddress:t.delegation.validatorAddress}))),pagination:t.pagination})),w(e).then(e=>({items:e.unbondingResponses.reduce((e,t)=>(e.push(...t.entries.map(e=>({balance:{amount:e.balance,denom:"uxion"},completionTime:Number(e.completionTime.seconds),completionTimeNanos:e.completionTime.nanos,id:e.unbondingId.toString(),validator:t.validatorAddress}))),e),[]),pagination:e.pagination})).catch(()=>({items:[],pagination:null})).then(e=>({items:e.items,pagination:e.pagination}))]);t.dispatch((0,D.d0)(l)),t.dispatch((0,D.T2)({items:d.validators,nextKey:(null===(n=d.pagination)||void 0===n?void 0:n.nextKey)||null,total:(null===(a=d.pagination)||void 0===a?void 0:a.total)||null},!0)),t.dispatch((0,D.Qx)({items:c.items,nextKey:(null===(i=c.pagination)||void 0===i?void 0:i.nextKey)||null,total:(null===(r=c.pagination)||void 0===r?void 0:r.total)||null},!0)),t.dispatch((0,D.Kg)({items:u.items,nextKey:(null===(o=u.pagination)||void 0===o?void 0:o.nextKey)||null,total:(null===(s=u.pagination)||void 0===s?void 0:s.total)||null},!0))}catch(e){console.error("error fetching staking data:",e)}},N=async(e,t,n)=>{await y(e,t,{amount:"1000",denom:"uxion"}),await S(e.delegator,n)},C=async(e,t,n)=>{console.log("debug: actions.ts: result",await A(e,t,{amount:"1000",denom:"uxion"})),await S(e.delegator,n)},T=async(e,t,n)=>{console.log("debug: actions.ts: result",await j(e,t)),await S(e.delegator,n)},E=async(e,t,n)=>{console.log("debug: actions.ts: result",await k(e,t)),await S(e,n)}},80469:function(e,t,n){"use strict";n.d(t,{f:function(){return l},n:function(){return s}});var a=n(52674),i=n(64090),r=n(94108),o=n(544);let s=()=>{let e=(0,i.useRef)({}),t=(0,i.useContext)(o.Y);e.current.state=t.state,e.current.dispatch=t.dispatch;let{data:n,isConnected:r}=(0,a.hT)(),s=null==n?void 0:n.bech32Address;return{account:n,address:s,isConnected:r,staking:e.current}},l=()=>{let{address:e,isConnected:t,staking:n}=s();(0,i.useEffect)(()=>{t&&e&&(0,r.wX)(e,n)},[t,e,n])}},62986:function(e,t,n){"use strict";n.d(t,{I6:function(){return c},Kg:function(){return o},Qx:function(){return r},T2:function(){return i},d0:function(){return a}});let a=e=>({content:e,type:"SET_TOKENS"}),i=(e,t)=>({content:e,reset:t,type:"ADD_VALIDATORS"}),r=(e,t)=>({content:e,reset:t,type:"ADD_DELEGATIONS"}),o=(e,t)=>({content:e,reset:t,type:"ADD_UNBONDINGS"}),s=e=>{let t=new Set;return e.filter(e=>!t.has(e.operatorAddress)&&(t.add(e.operatorAddress),!0))},l=e=>{let t=new Set;return e.filter(e=>!t.has(e.validatorAddress)&&(t.add(e.validatorAddress),!0))},d=e=>{let t=new Set;return e.filter(e=>{let n=e.id;return!t.has(n)&&(t.add(n),!0)})},c=(e,t)=>{switch(t.type){case"SET_TOKENS":return{...e,tokens:t.content};case"ADD_VALIDATORS":{let n=!t.reset&&e.validators||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=s(n.items.concat(t.content.items)),{...e,validators:n}}case"ADD_DELEGATIONS":{let n=!t.reset&&e.delegations||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=l(t.content.items.concat(n.items)),{...e,delegations:n}}case"ADD_UNBONDINGS":{let n=!t.reset&&e.unbondings||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=d(t.content.items.concat(n.items)),{...e,unbondings:n}}default:return e}}},544:function(e,t,n){"use strict";n.d(t,{W:function(){return i},Y:function(){return r}});var a=n(64090);let i={delegations:null,tokens:null,unbondings:null,validators:null},r=(0,a.createContext)({dispatch:()=>null,state:i})},66803:function(e,t,n){"use strict";n.d(t,{Em:function(){return r},HJ:function(){return s},bI:function(){return i}});var a=n(22840);let i=e=>{var t,n,i;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"?{amount:new a.Z(e.amount).div(new a.Z(10).pow(6)).toString(),denom:"XION"}:(null===(n=e.denom)||void 0===n?void 0:n.toUpperCase())==="XION"?{amount:e.amount,denom:"XION"}:{...e,denom:null===(i=e.denom)||void 0===i?void 0:i.toUpperCase()}},r=e=>{let t=i(e),n=new a.Z(t.amount);return"".concat(n.toFormat()," ").concat(t.denom)},o=()=>({amount:"0",denom:"xion"}),s=e=>e.reduce((e,t)=>({amount:(parseFloat(e.amount)+parseFloat(i(t).amount)).toString(),denom:t.denom}),o())},9016:function(e,t,n){"use strict";n.d(t,{Bv:function(){return a},Od:function(){return r},T$:function(){return i}});let{chainId:a}=n(3436).testnetChainInfo,i=void 0,r="https://rpc.xion-testnet.forbole.com"}},function(e){e.O(0,[350,218,147,228,933,45,792,971,69,744],function(){return e(e.s=96496)}),_N_E=e.O()}]);