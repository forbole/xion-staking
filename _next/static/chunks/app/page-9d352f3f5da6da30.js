(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46601:function(){},89214:function(){},42480:function(){},85568:function(){},69386:function(){},31616:function(){},20131:function(){},16026:function(){},33370:function(){},96496:function(e,t,n){Promise.resolve().then(n.bind(n,68454))},68454:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var a=n(3827),i=n(52674),r=n(80469),o=n(62331),s=n(8792),l=n(64090),d=n(88197),c=n(66803),u=n(9016),m=n(18722),g=()=>{let[e,t]=(0,l.useState)(null);return((0,l.useEffect)(()=>{(async()=>{var e;let n=localStorage.getItem("xion-authz-temp-account");if(!n)return;let a=await m.DirectSecp256k1HdWallet.deserialize(n,"abstraxion"),i=await a.getAccounts(),r=null==i?void 0:null===(e=i[0])||void 0===e?void 0:e.address;r&&t(r)})()},[]),e)?(0,a.jsx)(s.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e),target:"_blank",children:(0,a.jsx)(o.z,{onClick:()=>{},children:"DEBUG ACCOUNT"})}):null};let v=e=>{let{disabled:t,onStake:n,validator:i}=e,{website:r}=i.description;return(0,a.jsxs)("div",{style:{border:"solid 1ps white",marginBottom:10},children:[(0,a.jsx)("div",{children:(0,a.jsx)("b",{children:i.description.moniker})}),(0,a.jsx)("div",{children:i.operatorAddress}),(0,a.jsx)("div",{children:(0,a.jsx)(o.z,{disabled:t,onClick:n,structure:"naked",children:"Stake here"})}),r&&(0,a.jsx)("div",{children:(0,a.jsx)(s.default,{href:r,target:"_blank",children:r})})]})};var x=(0,l.memo)(function(){let{account:e,staking:t}=(0,r.n)(),[n,m]=(0,l.useState)(!1),{delegations:x,tokens:f,unbondings:h,validators:p}=t.state,{client:w}=(0,i.Hj)(),[,b]=(0,i.dd)(),y=(0,l.useMemo)(()=>(null==p?void 0:p.items.reduce((e,t)=>(e[t.operatorAddress]=t,e),{}))||{},[p]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{children:"Account"}),(0,a.jsx)("div",{children:(0,a.jsx)("b",{children:e.bech32Address})}),(0,a.jsx)("div",{children:(0,a.jsx)(o.z,{onClick:()=>{b(!0)},children:"Open Settings"})}),f&&(0,a.jsxs)("div",{children:["Tokens: ",(0,a.jsx)("b",{children:(0,c.Em)(f)})]})]}),!!(null==x?void 0:x.items.length)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Delegations:"}),x.items.map(i=>{let r=y[i.validatorAddress],s=null==r?void 0:r.description.moniker;return(0,a.jsxs)("div",{style:{border:"1px solid #fff",marginBottom:20},children:[(0,a.jsxs)("div",{children:["Delegated: ",(0,c.Em)(i.balance)]}),i.rewards&&(0,a.jsxs)("div",{children:["Rewards: ",(0,c.Em)(i.rewards)]}),(0,a.jsxs)("div",{children:["Validator: ",s||i.validatorAddress]}),(0,a.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,a.jsx)(o.z,{disabled:n,onClick:()=>{if(!w||!r)return;m(!0);let n={delegator:e.bech32Address,validator:r.operatorAddress};(0,d.xu)(n,w,t).finally(()=>{m(!1)})},children:"Undelegate"}),i.rewards&&(0,a.jsx)(o.z,{disabled:n||"0"===i.rewards.amount,onClick:()=>{if(!w)return;m(!0);let n={delegator:e.bech32Address,validator:i.validatorAddress};(0,d.sT)(n,w,t).finally(()=>{m(!1)})},children:"Claim rewards"}),(0,a.jsx)(o.z,{disabled:n,onClick:()=>{w&&(m(!0),(0,d.d7)(e.bech32Address,w,t).finally(()=>{m(!1)}))},children:"Redelelegate"})]})]},i.validatorAddress)})]}),!!(null==h?void 0:h.items.length)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Unbondings:"}),(0,a.jsx)("div",{children:null==h?void 0:h.items.map(e=>{let t=y[e.validator];return(0,a.jsxs)("div",{style:{border:"1px solid #fff"},children:["Unbonding tokens: ",(0,c.Em)(e.balance)," ","(completed by:"," ",new Date(e.completionTime).toString(),") Validator:"," ",(null==t?void 0:t.description.moniker)||e.validator]},"".concat(e.completionTime,"-").concat(e.completionTimeNanos))})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,a.jsx)(s.default,{href:"https://explorer.burnt.com/".concat(u.Bv,"/account/").concat(e.bech32Address),target:"_blank",children:(0,a.jsx)(o.z,{onClick:()=>{},children:"VIEW ACCOUNT"})}),(0,a.jsx)(g,{})]}),p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:"Validators:"}),(0,a.jsx)("div",{className:"max-h-[200px] max-w-max overflow-auto",children:p.items.map(i=>(0,a.jsx)(v,{disabled:n,onStake:()=>{if(!w)return;m(!0);let n={delegator:e.bech32Address,validator:i.operatorAddress};(0,d._5)(n,w,t).finally(()=>{m(!1)})},validator:i},i.operatorAddress))})]})]})});function f(){let[,e]=(0,i.dd)(),t=(0,l.useCallback)(()=>{e(!0)},[e]);return(0,a.jsx)("div",{className:"w-max",children:(0,a.jsx)(o.z,{fullWidth:!0,onClick:t,structure:"base",children:"CONNECT"})})}function h(){let{isLoggedIn:e}=(0,r.n)(),[t,n]=(0,i.dd)();return(0,a.jsxs)("main",{className:"m-auto flex min-h-screen max-w-xs flex-col items-center justify-center gap-4 p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tighter text-black dark:text-white",children:"XION Staking"}),e?(0,a.jsx)(x,{}):(0,a.jsx)(f,{}),t&&(0,a.jsx)(i.my,{onClose:()=>{n(!1)}})]})}},88197:function(e,t,n){"use strict";n.d(t,{sT:function(){return N},wX:function(){return A},d7:function(){return D},_5:function(){return j},xu:function(){return k}});var a=n(58015),i=n(43890),r=n(22840),o=n(53856),s=n(62884),l=n(66803),d=n(9016);let c=async()=>{let e=await i.Tendermint34Client.connect(d.Od);return a.QueryClient.withExtensions(e,a.setupStakingExtension,a.setupDistributionExtension,a.setupIbcExtension)},u=async e=>{let{address:t,amount:n=[{amount:"1000",denom:"uxion"}],client:a,gasLimit:i="400000",memo:r="",msgs:o}=e;return{amount:n,gas:i,granter:t}},m=async()=>{let e=await c();return await e.staking.validators("BOND_STATUS_BONDED")},g=async e=>{let t=await a.StargateClient.connect(d.Od);return await t.getBalance(e,"uxion")},v=async e=>{let t=await c();return await t.staking.delegatorDelegations(e)},x=async e=>{let t=await c();return await t.staking.delegatorUnbondingDelegations(e)},f=async(e,t)=>{let n=await c(),a=await n.distribution.delegationRewards(e,t);return(await Promise.all(a.rewards.map(async e=>{if(0==e.denom.indexOf("ibc/")){var t;let a=await n.ibc.transfer.denomTrace(e.denom.substring(4));e.denom=(null===(t=a.denomTrace)||void 0===t?void 0:t.baseDenom)||e.denom}return e}))).filter(e=>{var t;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"}).map(e=>({amount:new r.Z(e.amount).div(new r.Z(10).pow(18)).toString(),denom:e.denom})).map(e=>(0,l.bI)(e))},h=async(e,t,n)=>{let a=s.MsgDelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator}),i={amount:[{amount:"1000",denom:"uxion"}],gas:"200000",granter:e.delegator};return await t.signAndBroadcast(e.delegator,[{typeUrl:"/cosmos.staking.v1beta1.MsgDelegate",value:a}],i)},p=async(e,t,n)=>{let a={typeUrl:"/cosmos.staking.v1beta1.MsgUndelegate",value:s.MsgUndelegate.fromPartial({amount:n,delegatorAddress:e.delegator,validatorAddress:e.validator})},i=await u({address:e.delegator,client:t,msgs:[a]});return await t.signAndBroadcast(e.delegator,[a],i)},w=async(e,t)=>{let n={typeUrl:"/cosmos.distribution.v1beta1.MsgWithdrawDelegatorReward",value:o.MsgWithdrawDelegatorReward.fromPartial({delegatorAddress:e.delegator,validatorAddress:e.validator})},a=await u({address:e.delegator,client:t,msgs:[n]});return await t.signAndBroadcast(e.delegator,[n],a)},b=async(e,t)=>{let n={typeUrl:"/cosmos.staking.v1beta1.MsgBeginRedelegate",value:s.MsgBeginRedelegate.fromPartial({delegatorAddress:e})},a=await u({address:e,client:t,msgs:[n]});return await t.signAndBroadcast(e,[n],a)};var y=n(62986);let A=async(e,t)=>{try{var n,a,i,r,o,s;let[d,c,u,h]=await Promise.all([g(e),m(),v(e).then(async t=>({items:await Promise.all(t.delegationResponses.map(async t=>({balance:t.balance,rewards:await f(e,t.delegation.validatorAddress).then(e=>(0,l.HJ)(e)),validatorAddress:t.delegation.validatorAddress}))),pagination:t.pagination})),x(e).then(e=>({items:e.unbondingResponses.reduce((e,t)=>(e.push(...t.entries.map(e=>({balance:{amount:e.balance,denom:"uxion"},completionTime:Number(e.completionTime.seconds),completionTimeNanos:e.completionTime.nanos,id:e.unbondingId.toString(),validator:t.validatorAddress}))),e),[]),pagination:e.pagination})).catch(()=>({items:[],pagination:null})).then(e=>({items:e.items,pagination:e.pagination}))]);t.dispatch((0,y.d0)(d)),t.dispatch((0,y.T2)({items:c.validators,nextKey:(null===(n=c.pagination)||void 0===n?void 0:n.nextKey)||null,total:(null===(a=c.pagination)||void 0===a?void 0:a.total)||null},!0)),t.dispatch((0,y.Qx)({items:u.items,nextKey:(null===(i=u.pagination)||void 0===i?void 0:i.nextKey)||null,total:(null===(r=u.pagination)||void 0===r?void 0:r.total)||null},!0)),t.dispatch((0,y.Kg)({items:h.items,nextKey:(null===(o=h.pagination)||void 0===o?void 0:o.nextKey)||null,total:(null===(s=h.pagination)||void 0===s?void 0:s.total)||null},!0))}catch(e){console.error("error fetching staking data:",e)}},j=async(e,t,n)=>{await h(e,t,{amount:"1000",denom:"uxion"}),await A(e.delegator,n)},k=async(e,t,n)=>{console.log("debug: actions.ts: result",await p(e,t,{amount:"1000",denom:"uxion"})),await A(e.delegator,n)},N=async(e,t,n)=>{console.log("debug: actions.ts: result",await w(e,t)),await A(e.delegator,n)},D=async(e,t,n)=>{console.log("debug: actions.ts: result",await b(e,t)),await A(e,n)}},80469:function(e,t,n){"use strict";n.d(t,{f:function(){return l},n:function(){return s}});var a=n(52674),i=n(64090),r=n(76958),o=n(88197);let s=()=>{let e=(0,i.useRef)({}),t=(0,i.useContext)(r.Y);e.current.state=t.state,e.current.dispatch=t.dispatch;let{data:n}=(0,a.hT)(),o=null==n?void 0:n.bech32Address;return{account:n,address:o,isLoggedIn:!!(null==n?void 0:n.bech32Address),staking:e.current}},l=()=>{let{address:e,isLoggedIn:t,staking:n}=s();(0,i.useEffect)(()=>{t&&e&&(0,o.wX)(e,n)},[t,e,n])}},76958:function(e,t,n){"use strict";n.d(t,{W:function(){return i},Y:function(){return r}});var a=n(64090);let i={delegations:null,tokens:null,unbondings:null,validators:null},r=(0,a.createContext)({dispatch:()=>null,state:i})},62986:function(e,t,n){"use strict";n.d(t,{I6:function(){return c},Kg:function(){return o},Qx:function(){return r},T2:function(){return i},d0:function(){return a}});let a=e=>({content:e,type:"SET_TOKENS"}),i=(e,t)=>({content:e,reset:t,type:"ADD_VALIDATORS"}),r=(e,t)=>({content:e,reset:t,type:"ADD_DELEGATIONS"}),o=(e,t)=>({content:e,reset:t,type:"ADD_UNBONDINGS"}),s=e=>{let t=new Set;return e.filter(e=>!t.has(e.operatorAddress)&&(t.add(e.operatorAddress),!0))},l=e=>{let t=new Set;return e.filter(e=>!t.has(e.validatorAddress)&&(t.add(e.validatorAddress),!0))},d=e=>{let t=new Set;return e.filter(e=>{let n=e.id;return!t.has(n)&&(t.add(n),!0)})},c=(e,t)=>{switch(t.type){case"SET_TOKENS":return{...e,tokens:t.content};case"ADD_VALIDATORS":{let n=!t.reset&&e.validators||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=s(n.items.concat(t.content.items)),{...e,validators:n}}case"ADD_DELEGATIONS":{let n=!t.reset&&e.delegations||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=l(t.content.items.concat(n.items)),{...e,delegations:n}}case"ADD_UNBONDINGS":{let n=!t.reset&&e.unbondings||{items:[],nextKey:null,total:null};return n.total=t.content.total,n.nextKey=t.content.nextKey,n.items=d(t.content.items.concat(n.items)),{...e,unbondings:n}}default:return e}}},66803:function(e,t,n){"use strict";n.d(t,{Em:function(){return r},HJ:function(){return s},bI:function(){return i}});var a=n(22840);let i=e=>{var t,n,i;return(null===(t=e.denom)||void 0===t?void 0:t.toUpperCase())==="UXION"?{amount:new a.Z(e.amount).div(new a.Z(10).pow(6)).toString(),denom:"XION"}:(null===(n=e.denom)||void 0===n?void 0:n.toUpperCase())==="XION"?{amount:e.amount,denom:"XION"}:{...e,denom:null===(i=e.denom)||void 0===i?void 0:i.toUpperCase()}},r=e=>{let t=i(e),n=new a.Z(t.amount);return"".concat(n.toFormat()," ").concat(t.denom)},o=()=>({amount:"0",denom:"xion"}),s=e=>e.reduce((e,t)=>({amount:(parseFloat(e.amount)+parseFloat(i(t).amount)).toString(),denom:t.denom}),o())},9016:function(e,t,n){"use strict";n.d(t,{Bv:function(){return a},Od:function(){return r},T$:function(){return i}});let{chainId:a}=n(3436).testnetChainInfo,i=void 0,r="https://rpc.xion-testnet.forbole.com"}},function(e){e.O(0,[350,218,147,228,933,565,792,971,69,744],function(){return e(e.s=96496)}),_N_E=e.O()}]);